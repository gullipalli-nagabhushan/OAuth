<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script>
// Read provider from URL
const params = new URLSearchParams(window.location.search);
const providerName = params.get("provider"); // "google" or "github"

// Firebase init
 console.log("Firebase initialized");
  const firebaseConfig = {
      apiKey: "AIzaSyDAEoNzIPqr7Fhbz3F8w-1TnfqWf7e3JWo",
      authDomain: "smart-sdlc-e1473.firebaseapp.com",
  };

  // Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// Choose provider
let provider;
if (providerName === "github") {
  provider = new firebase.auth.GithubAuthProvider();
} else {
  provider = new firebase.auth.GoogleAuthProvider();
}

// Popup login
auth.signInWithPopup(provider)
  .then(result => result.user.getIdToken())
  .then(idToken => {
    window.opener.postMessage({ idToken }, "*");
    window.close();
  })
  .catch(err => {
    alert("Login failed: " + err.message);
    window.close();
  });
  
  window.addEventListener("load", () => {
    if (window.opener) {
      window.opener.postMessage({ error: "Login cancelled or blocked" }, "*");
    }
  });
</script>
